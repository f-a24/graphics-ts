!function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=4)}([function(t,e,i){var o=i(1),n=i(2);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var r={insert:"head",singleton:!1},s=(o(n,r),n.locals?n.locals:{});t.exports=s},function(t,e,i){"use strict";var o,n=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},r=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),s=[];function a(t){for(var e=-1,i=0;i<s.length;i++)if(s[i].identifier===t){e=i;break}return e}function h(t,e){for(var i={},o=[],n=0;n<t.length;n++){var r=t[n],h=e.base?r[0]+e.base:r[0],c=i[h]||0,f="".concat(h," ").concat(c);i[h]=c+1;var u=a(f),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(s[u].references++,s[u].updater(p)):s.push({identifier:f,updater:v(p,e),references:1}),o.push(f)}return o}function c(t){var e=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var n=i.nc;n&&(o.nonce=n)}if(Object.keys(o).forEach((function(t){e.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(e);else{var s=r(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var f,u=(f=[],function(t,e){return f[t]=e,f.filter(Boolean).join("\n")});function p(t,e,i,o){var n=i?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=u(e,n);else{var r=document.createTextNode(n),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(r,s[e]):t.appendChild(r)}}function l(t,e,i){var o=i.css,n=i.media,r=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),r&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var d=null,y=0;function v(t,e){var i,o,n;if(e.singleton){var r=y++;i=d||(d=c(e)),o=p.bind(null,i,r,!1),n=p.bind(null,i,r,!0)}else i=c(e),o=l.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=n());var i=h(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<i.length;o++){var n=a(i[o]);s[n].references--}for(var r=h(t,e),c=0;c<i.length;c++){var f=a(i[c]);0===s[f].references&&(s[f].updater(),s.splice(f,1))}i=r}}}},function(t,e,i){(e=i(3)(!1)).push([t.i,"/* http://meyerweb.com/eric/tools/css/reset/\n   v5.0.1 | 20191019\n   License: none (public domain)\n*/\n\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, menu, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed,\nfigure, figcaption, footer, header, hgroup,\nmain, menu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tfont-size: 100%;\n\tfont: inherit;\n\tvertical-align: baseline;\n}\n/* HTML5 display-role reset for older browsers */\narticle, aside, details, figcaption, figure,\nfooter, header, hgroup, main, menu, nav, section {\n\tdisplay: block;\n}\n/* HTML5 hidden-attribute fix for newer browsers */\n*[hidden] {\n    display: none;\n}\nbody {\n\tline-height: 1;\n}\nmenu, ol, ul {\n\tlist-style: none;\n}\nblockquote, q {\n\tquotes: none;\n}\nblockquote:before, blockquote:after,\nq:before, q:after {\n\tcontent: '';\n\tcontent: none;\n}\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\n",""]),t.exports=e},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",o=t[3];if(!o)return i;if(e&&"function"==typeof btoa){var n=(s=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(h," */")),r=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[i].concat(r).concat([n]).join("\n")}var s,a,h;return[i].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,o){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(o)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(n[s]=!0)}for(var a=0;a<t.length;a++){var h=[].concat(t[a]);o&&n[h[0]]||(i&&(h[2]?h[2]="".concat(i," and ").concat(h[2]):h[2]=i),e.push(h))}},e}},function(t,e,i){"use strict";i.r(e);var o,n=function(){function t(t,e){this.x=t,this.y=e}return t.calcLength=function(t,e){return Math.sqrt(t*t+e*e)},t.calcNormal=function(e,i){var o=t.calcLength(e,i);return new t(e/o,i/o)},t.prototype.set=function(t,e){this.x=t,this.y=e},t.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return 0===e?new t(0,0):new t(this.x/e,this.y/e)},t.prototype.rotate=function(t){var e=Math.sin(t),i=Math.cos(t);this.x=this.x*i+this.y*-e,this.y=this.x*e+this.y*i},t}(),r=function(){function t(t,e,i,o,r,s,a){var h=this;this.ctx=t,this.position=new n(e,i),this.vector=new n(0,-1),this.angle=270*Math.PI/180,this.width=o,this.height=r,this.life=s,this.ready=!1,this.image=new Image,this.image.addEventListener("load",(function(){h.ready=!0})),this.image.src=a}return t.prototype.setVector=function(t,e){this.vector.set(t,e)},t.prototype.setVectorFromAngle=function(t){this.angle=t,this.vector.set(Math.cos(t),Math.sin(t))},t.prototype.draw=function(){var t=this.width/2,e=this.height/2;this.ctx.drawImage(this.image,this.position.x-t,this.position.y-e,this.width,this.height)},t.prototype.rotationDraw=function(){this.ctx.save(),this.ctx.translate(this.position.x,this.position.y),this.ctx.rotate(this.angle-1.5*Math.PI);var t=this.width/2,e=this.height/2;this.ctx.drawImage(this.image,-t,-e,this.width,this.height),this.ctx.restore()},t}(),s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=function(t){function e(e,i,o,n,r,s){var a=t.call(this,e,i,o,n,r,0,s)||this;return a.mode="",a.frame=0,a.speed=3,a.shotArray=null,a.homingArray=null,a.attackTarget=null,a}return s(e,t),e.prototype.set=function(t,e,i){void 0===i&&(i=1),this.position.set(t,e),this.life=i,this.frame=0},e.prototype.setShotArray=function(t){this.shotArray=t},e.prototype.setHomingArray=function(t){this.homingArray=t},e.prototype.setAttackTarget=function(t){this.attackTarget=t},e.prototype.setMode=function(t){this.mode=t},e.prototype.update=function(){if(!(this.life<=0)){switch(this.mode){case"invade":this.position.y+=this.speed,this.position.y>100&&(this.position.y=100,this.mode="floating",this.frame=0);break;case"escape":this.position.y-=this.speed,this.position.y<-this.height&&(this.life=0);break;case"floating":if(this.frame%1e3<500){if(this.frame%200>140&&this.frame%10==0){var t=this.attackTarget.position.x-this.position.x,e=this.attackTarget.position.y-this.position.y,i=n.calcNormal(t,e);this.fire(i.x,i.y,3)}}else this.frame%50==0&&this.homingFire(0,1,3.5);this.position.x+=2*Math.cos(this.frame/100)}this.draw(),++this.frame}},e.prototype.fire=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=1),void 0===i&&(i=5);for(var o=0;o<this.shotArray.length;++o)if(this.shotArray[o].life<=0){this.shotArray[o].set(this.position.x,this.position.y),this.shotArray[o].setSpeed(i),this.shotArray[o].setVector(t,e);break}},e.prototype.homingFire=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=1),void 0===i&&(i=3);for(var o=0;o<this.homingArray.length;++o)if(this.homingArray[o].life<=0){this.homingArray[o].set(this.position.x,this.position.y),this.homingArray[o].setSpeed(i),this.homingArray[o].setVector(t,e);break}},e}(r),h=function(){function t(t,e,i,o){void 0===o&&(o="#ffffff"),this.ctx=t,this.size=e,this.speed=i,this.color=o,this.position=null}return t.prototype.set=function(t,e){this.position=new n(t,e)},t.prototype.update=function(){this.ctx.fillStyle=this.color,this.position.y+=this.speed,this.ctx.fillRect(this.position.x-this.size/2,this.position.y-this.size/2,this.size,this.size),this.position.y+this.size>this.ctx.canvas.height&&(this.position.y=-this.size)},t}(),c=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),f=function(t){function e(e,i,o,n,r,s){var a=t.call(this,e,i,o,n,r,0,s)||this;return a.type="default",a.frame=0,a.speed=3,a.shotArray=null,a.attackTarget=null,a}return c(e,t),e.prototype.set=function(t,e,i,o){void 0===i&&(i=1),void 0===o&&(o="default"),this.position.set(t,e),this.life=i,this.type=o,this.frame=0},e.prototype.setShotArray=function(t){this.shotArray=t},e.prototype.setAttackTarget=function(t){this.attackTarget=t},e.prototype.update=function(){if(!(this.life<=0)){switch(this.type){case"wave":if(this.frame%60==0){var t=this.attackTarget.position.x-this.position.x,e=this.attackTarget.position.y-this.position.y,i=n.calcNormal(t,e);this.fire(i.x,i.y,4)}this.position.x+=Math.sin(this.frame/10),this.position.y+=2,this.position.y-this.height>this.ctx.canvas.height&&(this.life=0);break;case"large":if(this.frame%50==0)for(var o=0;o<360;o+=45){var r=o*Math.PI/180,s=Math.sin(r),a=Math.cos(r);this.fire(a,s,3)}this.position.x+=2*Math.sin((this.frame+90)/50),this.position.y+=1,this.position.y-this.height>this.ctx.canvas.height&&(this.life=0);break;case"default":default:50===this.frame&&this.fire(),this.position.x+=this.vector.x*this.speed,this.position.y+=this.vector.y*this.speed,this.position.y-this.height>this.ctx.canvas.height&&(this.life=0)}this.draw(),++this.frame}},e.prototype.fire=function(t,e,i){var o=this;void 0===t&&(t=0),void 0===e&&(e=1),void 0===i&&(i=5),this.shotArray.some((function(n){return n.life<=0&&(n.set(o.position.x,o.position.y),n.setSpeed(i),n.setVector(t,e),!0)}))},e}(r),u=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var o=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,n++)o[n]=r[s];return o},p=function(){function t(t,e,i,o,n,r){void 0===r&&(r="#ff1166"),this.ctx=t,this.life=!1,this.color=r,this.position=null,this.radius=e,this.count=i,this.startTime=0,this.timeRange=n,this.fireBaseSize=o,this.fireSize=[],this.firePosition=[],this.fireVector=[],this.sound=null}return t.prototype.set=function(t,e){var i=this;this.firePosition=[],this.fireVector=[],u(Array(this.count)).forEach((function(){i.firePosition.push(new n(t,e));var o=Math.random()*Math.PI*2,r=Math.sin(o),s=Math.cos(o),a=Math.random();i.fireVector.push(new n(s*a,r*a)),i.fireSize.push((.5*Math.random()+.5)*i.fireBaseSize)})),this.life=!0,this.startTime=Date.now(),this.sound&&this.sound.play()},t.simpleEaseIn=function(t){return t*t*t*t},t.prototype.setSound=function(t){this.sound=t},t.prototype.update=function(){var e=this;if(this.life){this.ctx.fillStyle=this.color,this.ctx.globalAlpha=.5;var i=(Date.now()-this.startTime)/1e3,o=1-t.simpleEaseIn(1-Math.min(i/this.timeRange,1));this.firePosition.forEach((function(t,i){var n=e.radius*o,r=t.x+e.fireVector[i].x*n,s=t.y+e.fireVector[i].y*n,a=1-o;e.ctx.fillRect(r-e.fireSize[i]*a/2,s-e.fireSize[i]*a/2,e.fireSize[i]*a,e.fireSize[i]*a)})),o>=1&&(this.life=!1)}},t}(),l=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),d=function(t){function e(e,i,o,n,r,s){var a=t.call(this,e,i,o,n,r,1,s)||this;return a.speed=10,a.shotCheckCounter=0,a.shotInterval=5,a.isComing=!1,a.comingStart=null,a.comingStartPosition=null,a.comingEndPosition=null,a.shotArray=null,a.singleShotArray=null,a}return l(e,t),e.prototype.setComing=function(t,e,i,o){this.life=1,this.isComing=!0,this.comingStart=Date.now(),this.position.set(t,e),this.comingStartPosition=new n(t,e),this.comingEndPosition=new n(i,o)},e.prototype.setShotArray=function(t,e){this.shotArray=t,this.singleShotArray=e},e.prototype.update=function(){var t=this;if(!(this.life<=0)){var e=Date.now();if(!0===this.isComing){var i=(e-this.comingStart)/1e3,o=this.comingStartPosition.y-200*i;o<=this.comingEndPosition.y&&(this.isComing=!1,o=this.comingEndPosition.y),this.position.set(this.position.x,o),e%100<50&&(this.ctx.globalAlpha=.5)}else{window.isKeyDown.key_ArrowLeft&&(this.position.x-=this.speed),window.isKeyDown.key_ArrowRight&&(this.position.x+=this.speed),!0===window.isKeyDown.key_ArrowUp&&(this.position.y-=this.speed),!0===window.isKeyDown.key_ArrowDown&&(this.position.y+=this.speed);var n=Math.min(Math.max(this.position.x,0),this.ctx.canvas.width),r=Math.min(Math.max(this.position.y,0),this.ctx.canvas.height);if(this.position.set(n,r),window.isKeyDown["key_ "]&&this.shotCheckCounter>=0){this.shotArray.some((function(e){return e.life<=0&&(e.set(t.position.x,t.position.y),e.setPower(2),t.shotCheckCounter=-t.shotInterval,!0)}));for(var s=0;s<this.singleShotArray.length;s+=2)if(this.singleShotArray[s].life<=0&&this.singleShotArray[s+1].life<=0){var a=280*Math.PI/180,h=260*Math.PI/180;this.singleShotArray[s].set(this.position.x,this.position.y),this.singleShotArray[s].setVectorFromAngle(a),this.singleShotArray[s+1].set(this.position.x,this.position.y),this.singleShotArray[s+1].setVectorFromAngle(h),this.shotCheckCounter=-this.shotInterval;break}}++this.shotCheckCounter}this.draw(),this.ctx.globalAlpha=1}},e}(r),y=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),v=function(t){function e(e,i,o,n,r,s){var a=t.call(this,e,i,o,n,r,0,s)||this;return a.speed=20,a.power=1,a.targetArray=[],a.explosionArray=[],a}return y(e,t),e.prototype.set=function(t,e){this.position.set(t,e),this.life=1},e.prototype.setSpeed=function(t){t&&t>0&&(this.speed=t)},e.prototype.setPower=function(t){t&&(this.power=t)},e.prototype.setTargets=function(t){t&&Array.isArray(t)&&t.length>0&&(this.targetArray=t)},e.prototype.setExplosions=function(t){t&&Array.isArray(t)&&t.length>0&&(this.explosionArray=t)},e.prototype.update=function(){var t=this;this.life<=0||((this.position.x+this.width<0||this.position.x-this.width>this.ctx.canvas.width||this.position.y+this.height<0||this.position.y-this.height>this.ctx.canvas.height)&&(this.life=0),this.position.x+=this.vector.x*this.speed,this.position.y+=this.vector.y*this.speed,this.targetArray.forEach((function(e){if(!(t.life<=0||e.life<=0)&&t.position.distance(e.position)<=(t.width+e.width)/4){if(e instanceof d&&e.isComing)return;if(e.life-=t.power,e.life<=0&&(t.explosionArray.some((function(t){return!t.life&&(t.set(e.position.x,e.position.y),!0)})),e instanceof f)){var i="large"===e.type?1e3:100;window.gameScore=Math.min(window.gameScore+i,99999)}t.life=0}})),this.rotationDraw())},e}(r),g=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),m=function(t){function e(e,i,o,n,r,s){var a=t.call(this,e,i,o,n,r,s)||this;return a.frame=0,a}return g(e,t),e.prototype.set=function(t,e,i,o){this.position.set(t,e),this.life=1,this.setSpeed(i),this.setPower(o),this.frame=0},e.prototype.update=function(){var t=this;if(!(this.life<=0)){(this.position.x+this.width<0||this.position.x-this.width>this.ctx.canvas.width||this.position.y+this.height<0||this.position.y-this.height>this.ctx.canvas.height)&&(this.life=0);var e=this.targetArray[0];if(this.frame<100){var i=new n(e.position.x-this.position.x,e.position.y-this.position.y).normalize();this.vector=this.vector.normalize();var o=this.vector.cross(i),r=Math.PI/180;o>0?this.vector.rotate(r):o<0&&this.vector.rotate(-r)}this.position.x+=this.vector.x*this.speed,this.position.y+=this.vector.y*this.speed,this.angle=Math.atan2(this.vector.y,this.vector.x),this.targetArray.forEach((function(e){if(!(t.life<=0||e.life<=0)&&t.position.distance(e.position)<=(t.width+e.width)/4){if(e instanceof d&&e.isComing)return;if(e.life-=t.power,e.life<=0){for(var i=0;i<t.explosionArray.length;++i)if(!0!==t.explosionArray[i].life){t.explosionArray[i].set(e.position.x,e.position.y);break}if(e instanceof f){var o=100;"large"===e.type&&(o=1e3),window.gameScore=Math.min(window.gameScore+o,99999)}}t.life=0}})),this.rotationDraw(),++this.frame}},e}(v),x=function(){function t(){this.scene={},this.activeScene=null,this.startTime=0,this.frame=0}return t.prototype.add=function(t,e){this.scene[t]=e},t.prototype.use=function(t){!0===Object.prototype.hasOwnProperty.call(this.scene,t)&&(this.activeScene=this.scene[t],this.startTime=Date.now(),this.frame=-1)},t.prototype.update=function(){var t=(Date.now()-this.startTime)/1e3;this.activeScene(t),++this.frame},t}(),w=function(){function t(t){this.canvasElement=t,this.context2d=t.getContext("2d")}return Object.defineProperty(t.prototype,"canvas",{get:function(){return this.canvasElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this.context2d},enumerable:!0,configurable:!0}),t.prototype.drawRect=function(t,e,i,o,n){n&&(this.context2d.fillStyle=n),this.context2d.fillRect(t,e,i,o)},t.prototype.drawLine=function(t,e,i,o,n,r){void 0===r&&(r=1),n&&(this.context2d.strokeStyle=n),this.context2d.lineWidth=r,this.context2d.beginPath(),this.context2d.moveTo(t,e),this.context2d.lineTo(i,o),this.context2d.closePath(),this.context2d.stroke()},t.prototype.drawPolygon=function(t,e){if(Array.isArray(t)&&!(t.length<6)){e&&(this.context2d.fillStyle=e),this.context2d.beginPath(),this.context2d.moveTo(t[0],t[1]);for(var i=2;i<t.length;i+=2)this.context2d.lineTo(t[i],t[i+1]);this.context2d.closePath(),this.context2d.fill()}},t.prototype.drawCircle=function(t,e,i,o){o&&(this.context2d.fillStyle=o),this.context2d.beginPath(),this.context2d.arc(t,e,i,0,2*Math.PI),this.context2d.closePath(),this.context2d.fill()},t.prototype.drawFan=function(t,e,i,o,n,r){r&&(this.context2d.fillStyle=r),this.context2d.beginPath(),this.context2d.moveTo(t,e),this.context2d.arc(t,e,i,o,n),this.context2d.closePath(),this.context2d.fill()},t.prototype.drawQuadraticBezier=function(t,e,i,o,n,r,s,a){void 0===a&&(a=1),s&&(this.context2d.strokeStyle=s),this.context2d.lineWidth=a,this.context2d.beginPath(),this.context2d.moveTo(t,e),this.context2d.quadraticCurveTo(n,r,i,o),this.context2d.closePath(),this.context2d.stroke()},t.prototype.drawCubicBezier=function(t,e,i,o,n,r,s,a,h,c){void 0===c&&(c=1),h&&(this.context2d.strokeStyle=h),this.context2d.lineWidth=c,this.context2d.beginPath(),this.context2d.moveTo(t,e),this.context2d.bezierCurveTo(n,r,s,a,i,o),this.context2d.closePath(),this.context2d.stroke()},t.prototype.drawText=function(t,e,i,o,n){o&&(this.context2d.fillStyle=o),this.context2d.fillText(t,e,i,n)},t.imageLoader=function(t,e){var i=new Image;i.addEventListener("load",(function(){e&&e(i)})),i.src=t},t}(),b=window.innerWidth,A=window.innerHeight,_=(i(0),function(){function t(){this.ctx=new AudioContext,this.source=null}return t.prototype.load=function(t,e){var i=this;fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return i.ctx.decodeAudioData(t)})).then((function(t){i.source=t,e()})).catch((function(){e("error!")}))},t.prototype.play=function(){var t=new AudioBufferSourceNode(this.ctx,{buffer:this.source});t.connect(this.ctx.destination),t.addEventListener("ended",(function(){t.stop(),t.disconnect(),t=null})),t.start()},t}()),S=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var o=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,n++)o[n]=r[s];return o},k=new w(document.body.querySelector("#main_canvas")),M=new d(k.context,0,0,64,64,"./image/viper.png"),P=new a(k.context,0,0,128,128,"./image/boss.png"),T=[],E=[],C=[],O=new x,j=[],z=[],D=[],I=[],L=!1,q=null;window.isKeyDown={},window.gameScore=0,k.canvas.width=b,k.canvas.height=A;var R="Press the enter key to start the game";k.context.font="bold 72px sans-serif";var V=k.context.measureText(R).width;k.drawText(R,(b-V)/2,A/2,"#000");var F=function(t){return t*Math.PI/180},N=function(){var t=!0;t=t&&M.ready,C.forEach((function(e){t=t&&e.ready})),j.forEach((function(e){t=t&&e.ready})),T.forEach((function(e){t=t&&e.ready})),E.forEach((function(e){t=t&&e.ready})),z.forEach((function(e){t=t&&e.ready})),t?(K(),B(),H()):setTimeout(N,100)},K=function(){window.addEventListener("keydown",(function(t){window.isKeyDown["key_"+t.key]=!0,"Enter"===t.key&&M.life<=0&&(L=!0)})),window.addEventListener("keyup",(function(t){window.isKeyDown["key_"+t.key]=!1}))},B=function(){O.add("intro",(function(t){t>2&&O.use("invade_default_type")})),O.add("invade_default_type",(function(){if(O.frame%30==0)for(var t=0;t<20;++t)if(C[t].life<=0){var e=C[t];O.frame%60==0?(e.set(-e.width,30,2,"default"),e.setVectorFromAngle(F(30))):(e.set(b+e.width,30,2,"default"),e.setVectorFromAngle(F(150)));break}270===O.frame&&O.use("blank"),M.life<=0&&O.use("gameover")})),O.add("blank",(function(){150===O.frame&&O.use("invade_wave_move_type"),M.life<=0&&O.use("gameover")})),O.add("invade_wave_move_type",(function(){if(O.frame%50==0)for(var t=0;t<20;++t)if(C[t].life<=0){var e=C[t];O.frame<=200?e.set(.2*b,-e.height,2,"wave"):e.set(.8*b,-e.height,2,"wave");break}450===O.frame&&O.use("invade_large_type"),M.life<=0&&O.use("gameover")})),O.add("invade_large_type",(function(){if(100===O.frame)for(var t=20;t<25;++t)if(C[t].life<=0){var e=C[t];e.set(b/2,-e.height,50,"large");break}500===O.frame&&O.use("invade_boss"),M.life<=0&&O.use("gameover")})),O.add("invade_boss",(function(){0===O.frame&&(P.set(b/2,-P.height,250),P.setMode("invade")),M.life<=0&&(O.use("gameover"),P.setMode("escape")),P.life<=0&&O.use("intro")})),O.add("gameover",(function(){var t=b/2,e=b+t,i=b-10*O.frame%e;k.context.font="bold 72px sans-serif",k.drawText("GAME OVER",i,A/2,"#ff0000",t),L&&(L=!1,window.gameScore=0,M.setComing(b/2,A+50,b/2,A-100),O.use("intro"))})),O.use("intro")},H=function(){var t,e;k.context.globalAlpha=1,k.drawRect(0,0,k.canvas.width,k.canvas.height,"#111122"),k.context.font="bold 24px monospace",k.drawText((t=window.gameScore,e=5,(new Array(e).join("0")+t).slice(-e)),30,50,"#fff"),O.update(),I.forEach((function(t){t.update()})),M.update(),C.forEach((function(t){t.update()})),j.forEach((function(t){t.update()})),T.forEach((function(t){t.update()})),E.forEach((function(t){t.update()})),z.forEach((function(t){t.update()})),D.forEach((function(t){t.update()})),requestAnimationFrame(H)};window.addEventListener("load",(function(){window.addEventListener("keydown",(function(t){"Enter"===t.key&&void 0===window.isKeyDown.key_Enter&&(window.isKeyDown.key_Enter=!1,(q=new _).load("./sound/explosion.mp3",(function(t){t?alert("ファイルの読み込みエラーです"):(!function(){M.setComing(b/2,A,b/2,A-200);for(var t=0;t<10;++t)D[t]=new p(k.context,100,15,40,1),D[t].setSound(q);for(t=0;t<50;++t)j[t]=new v(k.context,0,0,32,32,"./image/enemy_shot.png"),j[t].setTargets([M]),j[t].setExplosions(D);for(t=0;t<50;++t)z[t]=new m(k.context,0,0,32,32,"./image/homing_shot.png"),z[t].setTargets([M]),z[t].setExplosions(D);P.setShotArray(j),P.setHomingArray(z),P.setAttackTarget(M);for(t=0;t<20;++t)C[t]=new f(k.context,0,0,48,48,"./image/enemy_small.png"),C[t].setShotArray(j),C[t].setAttackTarget(M);for(t=0;t<5;++t)C[20+t]=new f(k.context,0,0,64,64,"./image/enemy_large.png"),C[20+t].setShotArray(j),C[20+t].setAttackTarget(M);C.push(P),S(Array(10)).forEach((function(){var t=new v(k.context,0,0,32,32,"./image/viper_shot.png");t.setTargets(C),t.setExplosions(D),T.push(t);var e=new v(k.context,0,0,32,32,"./image/viper_single_shot.png"),i=new v(k.context,0,0,32,32,"./image/viper_single_shot.png");e.setTargets(C),i.setTargets(C),e.setExplosions(D),i.setExplosions(D),E.push(e,i)})),M.setShotArray(T,E);for(t=0;t<100;++t){var e=1+2*Math.random(),i=1+9*Math.random();I[t]=new h(k.context,e,i);var o=Math.random()*b,n=Math.random()*A;I[t].set(o,n)}}(),N())})))}))}))}]);